<div class="row">
  <div class="col-sm-3">
    <h2>
      <input type="search" class="form-control" ng-model="searchQuery" placeholder="Search users" ng-change="searchUsers()" autofocus> 
    </h2>
  </div>
</div>

<div class="row">

  <div class="col-sm-9">

    <button class="btn btn-default btn-sm"><span class="glyphicon glyphicon-plus"></span> Add user</button>
    <div class="btn-group">
      <button type="button" class="btn btn-default btn-sm" ng-disabled="!usersSelected" data-toggle="tooltip" data-placement="top" title="Tooltip on top"><span class="glyphicon glyphicon-plus"></span> Add role</button>
      <button type="button" class="btn btn-default btn-sm" ng-disabled="!usersSelected"><span class="glyphicon glyphicon-minus"></span> Remove role</button>
    </div>

    <div class="panel panel-default margin-top">

      <table class="table">
        <thead>
          <tr>
            <th><label><input tri-state-checkbox elements="users" elements-selected="usersSelected"></label></th>
            <th>Username</th>
            <th>Firstname</th>
            <th>Lastname</th>
            <th>Phone</th>
            <th>E-mail</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="user in users" class="itemrow">
            <td><label><input type="checkbox" ng-model="user.isSelected"></label></td>
            <td ng-click="activateUserDetail(user.username)">{{user.username}}</td>
            <td ng-click="activateUserDetail(user.username)">{{user.firstName}}</td>
            <td ng-click="activateUserDetail(user.username)">{{user.lastName}}</td>
            <td ng-click="activateUserDetail(user.username)">{{user.cellPhone}}</td>
            <td ng-click="activateUserDetail(user.username)">{{user.email}}</td>
          </tr>
          <tr ng-if="!users.length && searchQuery">
            <td colspan="4">No results for search "{{searchQuery}}".</td>
          </tr>
        </tbody>
      </table>

    </div>

  </div>

  <div class="col-sm-3">
    
    <div class="panel panel-default">
      
      <div class="panel-heading"><h3 class="panel-title">Filter</h3></div>

      <div class="panel-body">
        <ul class="list-unstyled">
          <li ng-repeat="app in applications">
            <label>
              <input type="checkbox"> {{app.applicationName}}
            </label>
          </li>
        </ul>
      </div>

    </div>

  </div>

</div>

<!-- Modal -->
<div class="modal fade" id="userdetail" tabindex="-1" role="dialog" aria-labelledby="userdetaillabel" aria-hidden="true" ng-controller="UserdetailCtrl">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="userdetaillabel">{{user.identity.username}}</h4>
      </div>
      <div class="modal-body">

        <div class="form-horizontal">
          <div class="form-group" ng-repeat="property in editableUserProperties">
            <label for="{{property}}" class="col-sm-2 control-label">{{dict[lang][property]}}</label>
            <div class="col-sm-10"><input type="text" class="form-control" id="{{property}}" ng-model="user.identity[property]"></div>
          </div>
        </div>

        <button type="button" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-minus"></span> Remove selected roles</button>

        <table class="table">
          <thead>
            <tr>
              <th></th>
              <th ng-repeat="prop in editableRoleProperties">{{dict[lang][prop]}}</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="role in user.propsAndRoles">
              <td><input type="checkbox" ng-model="role.checked"></td>
              <td ng-repeat="prop in editableRoleProperties"><input type="text" class="form-control" ng-model="role[prop]" ng-show="role.editing"><span ng-show="!role.editing">{{role[prop]}}</span></td>
              <td>
                <button class="btn btn-default btn-sm" ng-click="role.editing=true" ng-show="!role.editing">
                  <span class="glyphicon glyphicon-pencil"></span>&nbsp;Edit
                </button>
                <button class="btn btn-default btn-sm" ng-click="role.editing=false" ng-show="role.editing">
                  <span class="glyphicon glyphicon-ok"></span>&nbsp;Done
                </button>
              </td>
            </tr>
            <tr ng-if="!user.propsAndRoles.length">
              <td colspan="{{editableRoleProperties.length+2}}">No roles yet.</td>
            </tr>
            <tr>
              <td colspan="{{editableRoleProperties.length+2}}">
                <button type="button" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-plus"></span> Add role</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>